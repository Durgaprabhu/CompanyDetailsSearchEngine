--DROP TABLES IF EXISTS

DROP TABLE IF EXISTS COMPANY_OFFICERS;
DROP TABLE IF EXISTS COMPANIES;
DROP TABLE IF EXISTS OFFICERS;
DROP TABLE IF EXISTS ADDRESSES;

--CREATE ADDRESSES TABLE

CREATE TABLE ADDRESSES (
ADDRESS_ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) PRIMARY KEY,
LOCALITY VARCHAR(100) NOT NULL,
ADDRESS_FIRST_LINE VARCHAR(100) NOT NULL,
POST_CODE VARCHAR(20) NOT NULL,
PREMISES VARCHAR(100) NOT NULL,
COUNTRY VARCHAR(40) NOT NULL,
CREATED_TIMESTAMP TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
UPDATED_TIMESTAMP TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

--CREATE OFFICERS TABLE

CREATE TABLE OFFICERS (
OFFICER_ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) PRIMARY KEY,
FIRST_NAME VARCHAR(40) NOT NULL,
LAST_NAME VARCHAR(40) NOT NULL,
OFFICER_ROLE VARCHAR(40) NOT NULL,
APPOINTED_ON DATE NOT NULL,
RESIGNED_ON DATE,
ADDRESS_ID INT NOT NULL,
CREATED_TIMESTAMP TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
UPDATED_TIMESTAMP TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY(ADDRESS_ID) REFERENCES ADDRESSES(ADDRESS_ID) ON DELETE SET NULL);

--CREATE COMPANIES TABLE

CREATE TABLE COMPANIES (
REGISTRATION_ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) PRIMARY KEY,
COMPANY_TYPE VARCHAR(10) NOT NULL,
COMPANY_NAME VARCHAR(50) NOT NULL,
COMPANY_STATUS VARCHAR(10) NOT NULL,
INCORPORATION_DATE DATE NOT NULL,
ADDRESS_ID INT NOT NULL,
CREATED_TIMESTAMP TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
UPDATED_TIMESTAMP TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY(ADDRESS_ID) REFERENCES ADDRESSES(ADDRESS_ID) ON DELETE SET NULL);

--CREATE COMPANY OFFICERS RELATIONSHIP TABLE
CREATE TABLE COMPANY_OFFICERS  (
REGISTRATION_ID INT,
OFFICER_ID INT,
PRIMARY KEY (REGISTRATION_ID, OFFICER_ID),
FOREIGN KEY(REGISTRATION_ID) REFERENCES COMPANIES(REGISTRATION_ID) ON DELETE CASCADE,
FOREIGN KEY(OFFICER_ID) REFERENCES OFFICERS(OFFICER_ID) ON DELETE CASCADE
);